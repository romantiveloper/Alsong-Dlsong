{% load static %}
<!DOCTYPE html>
<html lang="ko">

  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static 'css/nav_style.css' %}">
    {% block style %}{% endblock %}
    </head>
    
    <script src="https://kit.fontawesome.com/95c5c08857.js" crossorigin="anonymous"></script>
    <script src="{% static 'css/nav.js' %}" defer></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- ì„œì¹˜ë°” ë²„íŠ¼ ê¸°ëŠ¥ êµ¬í˜„ìš© script -->
    <script>
        // CSRF í† í° ì„¤ì •
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    // ì´ë¦„ìœ¼ë¡œ ì¿ í‚¤ ì°¾ê¸°
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        const csrftoken = getCookie('csrftoken');
    
        $.ajaxSetup({
            headers: { "X-CSRFToken": csrftoken }
        });
    
        $(document).ready(function() {
        $("submit-button").click(function() {
            var category = $(this).val();  // ë²„íŠ¼ì˜ ê°’(category)ì„ ê°€ì ¸ì˜´
            var query = $("input[name='query']").val();  // ê²€ìƒ‰ì–´ë¥¼ ê°€ì ¸ì˜´
    
            $.ajax({
                type: 'POST',
                url: '/song-list/',
                data: {
                    'category': category,
                    'query': query  // ê²€ìƒ‰ì–´(query)ë¥¼ ë°ì´í„°ì— í¬í•¨ì‹œí‚´
                },
                success: function(response) {
                    // í•„í„°ë§ëœ ë…¸ë˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°›ì•„ì™€ì„œ í™”ë©´ì— í‘œì‹œí•˜ëŠ” ë¡œì§ ì‘ì„±
                    console.log(response);
                    }
                });
            });
        });
    </script>

    <title>ğŸ¤ì•Œsongë‹¬song: {% block title %}{% endblock %}</title>
    

  <body>
    <nav class="navbar">

        <div class="navbar__logo">
            <!-- <i class="fas fa-blog">ì—¬ê¸° ë¡œê³ ì•„ì´ì½˜</i> -->
            <a href="http://127.0.0.1:8000/">ì•Œsongë‹¬songğŸ¤</a>
        </div>
        
      
      <ul class="navbar__menu">

        <li><a href="http://127.0.0.1:8000/song-list/">ğŸ…ì¸ê¸°ì°¨íŠ¸</a></li>
        <li><a href="http://127.0.0.1:8000/song-list/search/">ğŸ“ë‹¬ì†¡ë³´ê´€í•¨</a></li>
        <li><a href="http://127.0.0.1:8000/">ğŸ’ğŸ»ì•Œì†¡Ai</a></li>
        <li><a href="http://127.0.0.1:8000/">ğŸ“Šë‹¬ì†¡report</a></li>
        <li><a href="http://127.0.0.1:8000/user/mypage/">ğŸ‘¤My page</a></li>
         <!-- ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ì¶”ê°€ ì‹œì‘ -->
        {% if user.is_authenticated %}
        <li>
            <a href="{% url 'user:logout' %}">ğŸ”“ë¡œê·¸ì•„ì›ƒ</a>
        </li>
        {% else %}
        <li>
            <a href="{% url 'user:sign-in' %}">ğŸ”ë¡œê·¸ì¸</a>
        </li>
        {% endif %}
        <!-- ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ì¶”ê°€ ë -->
      </ul>

      <a href="#" class="navbar__toggleBtn">
        <i class="fas fa-bars"></i>
      </a>

    </nav>

    <!-- ì„œì¹˜ë°” -->
    <form class="search-form" action="/song-list/search/" method="GET">
        <input type="text" name="query" placeholder="ë¶€ë¥´ê³  ì‹¶ì€ ê³¡ì„ ì…ë ¥í•˜ì„¸ìš”!ğŸ¤" class="search-input">
        <button type="submit" class="search-button">
            <svg class="submit-button">
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#search"></use>
            </svg>
        </button>
     </form>

    <svg xmlns="http://www.w3.org/2000/svg" width="0" height="0" display="none">
        <symbol id="search" viewBox="0 0 32 32">
            <path d="M 19.5 3 C 14.26514 3 10 7.2651394 10 12.5 C 10 14.749977 10.810825 16.807458 12.125 18.4375 L 3.28125 27.28125 L 4.71875 28.71875 L 13.5625 19.875 C 15.192542 21.189175 17.250023 22 19.5 22 C 24.73486 22 29 17.73486 29 12.5 C 29 7.2651394 24.73486 3 19.5 3 z M 19.5 5 C 23.65398 5 27 8.3460198 27 12.5 C 27 16.65398 23.65398 20 19.5 20 C 15.34602 20 12 16.65398 12 12.5 C 12 8.3460198 15.34602 5 19.5 5 z" />
        </symbol>
    </svg>

    {% if messages %}
    <section id="messages">
        <ul>
            {% for message in messages %}
            <p class="{{ message.tags }}" style="text-align:right;">
                {{ message }}
            </p>
            {% endfor %}
        </ul>
    </section>
    {% endif %}
    {% block content %}{% endblock %}
    {% block script %}{% endblock %}
  </body>
</html>
